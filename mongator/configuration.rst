Configuration
=============

Classes loader
--------------

Mongator uses `namespaces and class names standards in PHP 5.3`_,
and includes the ClassLoader component of Symfony2::

    require_once('/path/to/mongator/vendor/symfony/src/Symfony/Component/ClassLoader/UniversalClassLoader.php');

    use Symfony\Component\ClassLoader\UniversalClassLoader;

    $loader = new UniversalClassLoader();
    $loader->registerNamespaces(array(
        'Mongator\Mondator' => '/path/to/mondator/src',
        'Mongator'          => '/path/to/mongator/src',
        'Model'             => dirname('/path/to/Model'),
    ));
    $loader->register();

.. tip::
  You can use any class loader that implements the standards in PHP 5.3.

The Mongator
------------

To use Mongator you have to create a ``mongator`` object and assign it any
connection.

To create the mongator object you have to pass it the metadata factory object
and a cache object. The metadata factory class is generated by Mongator, and
for the cache you can use any implementation of the
``Mongator\Cache\CacheInterface`` interface::

    use Mongator\Cache\FilesystemCache;
    use Mongator\Connection;
    use Mongator\Mongator;
    use Model\Mapping\MetadataFactory;

    $metadataFactory = new MetadataFactory();
    $cache = new FilesystemCache('/path/to/query/cache/dir');
    $mongator = new Mongator($metadataFactory, $cache);
    $connection = new Connection('mongodb://localhost:27017', 'database_name');
    $mongator->setConnection('my_connection', $connection);

If you want to specify a default connection in the mongator object you have to
do it explicitly::

    $mongator->setDefaultConnectionName('my_connection');

Connections
-----------

With Mongator you can use the number of connections that you want. They are
lazy, so they only connect to the server when they are going to be used::

    use Mongator\Mongator;
    use Mongator\Connection;

    // assigning several connections
    $mongator->setConnections(array(
        'local'  => new Connection('mongodb://localhost:27017', 'database_local'),
        'global' => new Connection('mongodb://localhost:27017', 'database_global'),
    ));

Options
^^^^^^^

You can also pass as a third parameter the options in the connection::

    use Mongator\Connection;

    $connection = new Connection('mongodb://localhost:27017', 'database', array(
        'persistent' => true,
    ));

.. note::
  You can see all the options that you can use in the connections in the
  `MongoDB documentation in PHP`_

.. _namespaces and class names standards in PHP 5.3: http://groups.google.com/group/php-standards/web/psr-0-final-proposal
.. _MongoDB documentation in PHP: http://www.php.net/manual/en/mongo.construct.php
